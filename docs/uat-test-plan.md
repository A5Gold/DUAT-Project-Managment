# UAT 驗收測試計劃

## MTR PS-OHLR DUAT v4.0.0

**最後更新**: 2026-02-14
**測試類型**: 使用者驗收測試（User Acceptance Testing）
**測試人員**: MTR PS-OHLR 團隊成員
**對應文件**: [prd.md](prd.md)（產品需求文件）

---

## 1. 測試目標

驗證 MTR DUAT v4.0.0 可攜式桌面應用符合 PRD 中所有 13 個 Epic 的驗收標準，確保使用者可在企業環境中正常使用所有功能。

---

## 2. 測試環境

| 項目 | 說明 |
|------|------|
| 作業系統 | Windows 10/11 企業版 |
| 安裝方式 | 可攜式 .exe，無需安裝 |
| 網路環境 | 企業內網，可存取 SharePoint |
| 測試資料 | 真實 DOCX 每日報告 + Project Master Excel |
| 前置條件 | 無需安裝 Python 或 Node.js |

---

## 3. UAT 測試案例

### UAT-01: 應用程式生命週期（Epic 1: Application Shell）

**對應**: US-1.1 Desktop Application Lifecycle

| # | 測試步驟 | 預期結果 | 通過 |
|---|----------|----------|------|
| 1 | 啟動 .exe | Electron Shell 啟動，顯示載入畫面 | [ ] |
| 2 | 等待 Sidecar 就緒 | 載入畫面顯示進度，Sidecar 在 15 秒內就緒 | [ ] |
| 3 | Sidecar 就緒後 | 自動載入 React SPA 首頁 | [ ] |
| 4 | 關閉應用視窗 | Sidecar 進程被終止，所有資源釋放 | [ ] |
| 5 | 點擊「選擇資料夾」 | 開啟 Windows 原生資料夾對話框 | [ ] |

**驗收標準**: 5/5 通過

---

### UAT-02: DOCX 解析（Epic 2: Data Ingestion）

**對應**: US-2.1 Folder Parsing

| # | 測試步驟 | 預期結果 | 通過 |
|---|----------|----------|------|
| 1 | 選擇 SharePoint 同步資料夾 | 掃描 `PS-OHLR_DUAT_Daily Report_*.docx`，排除 `~$` 暫存檔 | [ ] |
| 2 | 開始解析 | 提取日期、專案代碼（C####）、數量、週數、年份 | [ ] |
| 3 | 檢查藍色文字偵測 | 正確識別 CBM、CM、PA work、HLM、Provide 關鍵字 | [ ] |
| 4 | 檢查夜班記錄 | 夜班藍色關鍵字記錄數量為 0 | [ ] |
| 5 | 檢查鐵路線提取 | 正確提取 KTL/TCL/AEL/TWL/ISL/TKL/EAL/SIL/TML/DRL | [ ] |
| 6 | 放入損壞 DOCX | 記錄錯誤並繼續處理其餘檔案 | [ ] |
| 7 | 檢查解析結果 | 記錄包含 FullDate、Project、Qty Delivered、Week、Year、Line | [ ] |
| 8 | 觀察進度更新 | 顯示當前檔案名稱和百分比 | [ ] |

**驗收標準**: 8/8 通過

---

### UAT-03: 人力資料解析（Epic 3: Manpower Data Ingestion）

**對應**: US-3.1 Manpower Scan

| # | 測試步驟 | 預期結果 | 通過 |
|---|----------|----------|------|
| 1 | 觸發人力掃描 | 解析每日報告 DOCX 第二個表格 | [ ] |
| 2 | 檢查班次分段 | 正確分割 HLM、C&R Works、Attendance、Other Notable Items | [ ] |
| 3 | 檢查工作項目 | 識別 job type、project code、qty、worker names、team counts | [ ] |
| 4 | 檢查 EPIC 角色 | 正確提取 CP_P、CP_T、AP_E、SPC、HSM、NP | [ ] |
| 5 | 檢查請假分類 | 正確分類 AL、SH、SL、RD、Training | [ ] |

**驗收標準**: 5/5 通過

---

### UAT-04: 儀表板統計（Epic 4: Analytics Dashboard）

**對應**: US-4.1 Dashboard Statistics, US-4.2 Dashboard Export

| # | 測試步驟 | 預期結果 | 通過 |
|---|----------|----------|------|
| 1 | 觸發儀表板分析 | 計算總記錄數、總 NTH、總數量、專案數、最後更新時間 | [ ] |
| 2 | 檢視週趨勢圖 | 顯示 Projects vs Jobs 分類的週交付趨勢 | [ ] |
| 3 | 檢視月趨勢圖 | 顯示可配置回溯期的月交付趨勢 | [ ] |
| 4 | 檢視專案分佈圖 | 顯示各專案的 NTH 和數量分佈 | [ ] |
| 5 | 檢視關鍵字分佈圖 | 顯示各關鍵字的分佈統計 | [ ] |
| 6 | 檢視線路分佈圖 | 顯示各鐵路線的 NTH 和數量分佈 | [ ] |
| 7 | 檢視 NTH 趨勢表 | 顯示按週按專案的 NTH 樞紐表 | [ ] |
| 8 | 匯出 Excel | 生成包含 Raw Data、Summary by Project、NTH Trend 的 Excel | [ ] |
| 9 | 儲存至來源資料夾 | Excel 儲存為 "Progress Dashboard + NTH.xlsx" | [ ] |

**驗收標準**: 9/9 通過

---

### UAT-05: NTH 滯後分析（Epic 5: Lag/Lead Analysis）

**對應**: US-5.1 Project Master Import, US-5.2 Lag/Lead Calculation

| # | 測試步驟 | 預期結果 | 通過 |
|---|----------|----------|------|
| 1 | 上傳 Project Master Excel | 提取專案編號、標題、開始/結束日期、目標數量 | [ ] |
| 2 | 檢查欄位映射 | 不區分大小寫的欄位映射正確 | [ ] |
| 3 | 檢查生產力自動匹配 | 從儀表板摘要自動匹配 Qty per NTH | [ ] |
| 4 | 觸發滯後計算 | 計算 weeks elapsed、target to date、progress%、lag/lead | [ ] |
| 5 | 檢查 URGENT 狀態 | lag <= -10 顯示紅色 URGENT | [ ] |
| 6 | 檢查 BEHIND 狀態 | -10 < lag <= -5 顯示橙色 BEHIND | [ ] |
| 7 | 檢查 SLIGHT LAG 狀態 | -5 < lag < 0 顯示黃色 SLIGHT LAG | [ ] |
| 8 | 檢查 ON TRACK 狀態 | 0 <= lag < 5 顯示綠色 ON TRACK | [ ] |
| 9 | 檢查 AHEAD 狀態 | lag >= 5 顯示藍色 AHEAD | [ ] |
| 10 | 配置專案參數 | 可設定 target qty、productivity、skip flag | [ ] |
| 11 | 匯出滯後報告 | 生成包含完整分析結果的 Excel | [ ] |

**驗收標準**: 11/11 通過

---

### UAT-06: 績效追蹤（Epic 6: Performance Tracking）

**對應**: US-6.1 Performance Metrics, US-6.2 Recovery Path

| # | 測試步驟 | 預期結果 | 通過 |
|---|----------|----------|------|
| 1 | 選擇專案 | 顯示可用專案列表（C 開頭的代碼） | [ ] |
| 2 | 檢視績效指標 | 顯示週生產力、成功率、達標/未達標週數、當前速度 | [ ] |
| 3 | 檢視績效圖表 | 週績效長條圖（綠=達標、紅=未達標）+ 目標線 | [ ] |
| 4 | 檢視恢復分析 | 顯示所需週速率、完成所需週數、是否在軌 | [ ] |
| 5 | 檢視累計圖表 | 顯示計劃線、實際線、恢復路徑、預測速度線 | [ ] |
| 6 | 檢查預測完成日期 | 基於當前速度計算的預測完成日期 | [ ] |

**驗收標準**: 6/6 通過

---

### UAT-07: S-Curve 生成（Epic 7: S-Curve）

**對應**: US-7.1 S-Curve Charts and Reports

| # | 測試步驟 | 預期結果 | 通過 |
|---|----------|----------|------|
| 1 | 設定 S-Curve 參數 | 輸入專案代碼、目標數量、起止期間 | [ ] |
| 2 | 計算 S-Curve | 生成累計計劃和實際進度數據點 | [ ] |
| 3 | 檢視 S-Curve 圖表 | 目標線（藍色虛線）+ 實際線（綠色實線）+ 填充區域 | [ ] |
| 4 | 匯出 S-Curve 報告 | Excel 包含 Week/Target/Actual/Variance + 嵌入圖表 | [ ] |
| 5 | 測試無數據專案 | 輸入不存在的專案代碼，顯示描述性錯誤訊息 | [ ] |

**驗收標準**: 5/5 通過

---

### UAT-08: 關鍵字搜尋（Epic 8: Keyword Search）

**對應**: US-8.1 DOCX Keyword Search

| # | 測試步驟 | 預期結果 | 通過 |
|---|----------|----------|------|
| 1 | 輸入關鍵字搜尋 | 掃描所有匹配的 DOCX 檔案 | [ ] |
| 2 | 檢查搜尋結果 | 顯示檔案名稱、位置、上下文（最多 500 字元） | [ ] |
| 3 | 驗證不區分大小寫 | 大小寫不同的關鍵字均能匹配 | [ ] |
| 4 | 驗證去重 | 同一檔案內相同文字不重複顯示 | [ ] |
| 5 | 測試無結果 | 搜尋不存在的關鍵字，顯示零結果訊息 | [ ] |

**驗收標準**: 5/5 通過

---

### UAT-09: 人力分析（Epic 9: Manpower Analysis）

**對應**: US-9.1 Manpower Statistics

| # | 測試步驟 | 預期結果 | 通過 |
|---|----------|----------|------|
| 1 | 掃描人力資料 | 觸發人力掃描並等待完成 | [ ] |
| 2 | 檢視 KPI 卡片 | 總工作項目、平均工人數、唯一員工數、最高角色持有者 | [ ] |
| 3 | 檢視工作類型分析 | 按工作類型的平均團隊規模和 EPIC 角色 | [ ] |
| 4 | 檢視角色頻率表 | 每人 EPIC 角色分配頻率（按總數降序） | [ ] |
| 5 | 檢視工作存取分類 | Possession / PA work / SPA work / Other 分類正確 | [ ] |
| 6 | 檢視團隊分佈 | 每週 S2/S3/S4/S5 團隊分佈 | [ ] |
| 7 | 匯出人力報告 | Excel 包含 4 個工作表：Raw Data、Job Type、Role Freq、Weekly Team | [ ] |

**驗收標準**: 7/7 通過

---

### UAT-10: 國際化（Epic 10: Internationalization）

**對應**: US-10.1 Language Switching

| # | 測試步驟 | 預期結果 | 通過 |
|---|----------|----------|------|
| 1 | 切換至繁體中文 | 所有頁面文字更新為中文 | [ ] |
| 2 | 切換至英文 | 所有頁面文字更新為英文 | [ ] |
| 3 | 重啟後語言保留 | 關閉重開後語言設定保留 | [ ] |
| 4 | 檢查翻譯完整性 | 無未翻譯的 key 殘留（如 `dashboard.title`） | [ ] |

**驗收標準**: 4/4 通過

---

### UAT-11: 設定持久化（Epic 11: Configuration Persistence）

**對應**: US-11.1 Settings Persistence

| # | 測試步驟 | 預期結果 | 通過 |
|---|----------|----------|------|
| 1 | 修改設定 | 變更語言、資料夾路徑等設定 | [ ] |
| 2 | 立即儲存 | 設定變更後立即寫入 JSON 檔案 | [ ] |
| 3 | 重啟驗證 | 關閉重開後所有設定保留 | [ ] |
| 4 | 損壞設定檔 | 手動破壞 config.json，重啟後使用預設值 | [ ] |
| 5 | 刪除設定檔 | 刪除 config.json，重啟後使用預設值 | [ ] |

**驗收標準**: 5/5 通過

---

### UAT-12: 可攜式建置（Epic 12: Build and Distribution）

**對應**: US-12.1 Portable Desktop Build

| # | 測試步驟 | 預期結果 | 通過 |
|---|----------|----------|------|
| 1 | 無 Python 環境執行 | 在未安裝 Python 的機器上正常啟動 | [ ] |
| 2 | 無 Node.js 環境執行 | 在未安裝 Node.js 的機器上正常啟動 | [ ] |
| 3 | USB 隨身碟執行 | 從 USB 複製後直接執行 | [ ] |
| 4 | 完整功能驗證 | 在乾淨環境中所有功能正常 | [ ] |

**驗收標準**: 4/4 通過

---

## 4. 非功能需求驗證

### NFR-01: 效能

| # | 驗證項目 | 目標 | 實際 | 通過 |
|---|----------|------|------|------|
| 1 | DOCX 解析速度 | >= 10 files/sec | | [ ] |
| 2 | 儀表板分析（10,000 筆） | < 2 秒 | | [ ] |
| 3 | API 回應時間（非匯出） | < 500ms | | [ ] |

### NFR-02: 可靠性

| # | 驗證項目 | 通過 |
|---|----------|------|
| 1 | 損壞 DOCX 不導致崩潰 | [ ] |
| 2 | 缺失 Project Master 欄位有 fallback | [ ] |
| 3 | 空資料集回傳空結果（不崩潰） | [ ] |

### NFR-03: 可用性

| # | 驗證項目 | 通過 |
|---|----------|------|
| 1 | 長時間操作有進度回饋 | [ ] |
| 2 | 支援中英文切換 | [ ] |
| 3 | 設定在 session 間持久化 | [ ] |

### NFR-04: 可攜性

| # | 驗證項目 | 通過 |
|---|----------|------|
| 1 | Windows 10 正常運行 | [ ] |
| 2 | Windows 11 正常運行 | [ ] |
| 3 | 僅綁定 localhost（無網路暴露） | [ ] |

---

## 5. 測試結果摘要

| UAT ID | Epic | 測試項目數 | 通過 | 失敗 | 狀態 |
|--------|------|-----------|------|------|------|
| UAT-01 | E1 Application Shell | 5 | 0 | 0 | 待測 |
| UAT-02 | E2 DOCX Parsing | 8 | 0 | 0 | 待測 |
| UAT-03 | E3 Manpower Parsing | 5 | 0 | 0 | 待測 |
| UAT-04 | E4 Dashboard | 9 | 0 | 0 | 待測 |
| UAT-05 | E5 Lag Analysis | 11 | 0 | 0 | 待測 |
| UAT-06 | E6 Performance | 6 | 0 | 0 | 待測 |
| UAT-07 | E7 S-Curve | 5 | 0 | 0 | 待測 |
| UAT-08 | E8 Keyword Search | 5 | 0 | 0 | 待測 |
| UAT-09 | E9 Manpower Analysis | 7 | 0 | 0 | 待測 |
| UAT-10 | E10 i18n | 4 | 0 | 0 | 待測 |
| UAT-11 | E11 Config Persistence | 5 | 0 | 0 | 待測 |
| UAT-12 | E12 Portable Build | 4 | 0 | 0 | 待測 |

**總計**: 74 個測試項目 | **通過**: 0 | **失敗**: 0 | **待測**: 74

---

## 6. 簽核

| 角色 | 姓名 | 日期 | 簽名 |
|------|------|------|------|
| 測試負責人 | | | |
| 產品負責人 | | | |
| 開發負責人 | | | |

**UAT 結論**: [ ] 通過 / [ ] 有條件通過 / [ ] 未通過
