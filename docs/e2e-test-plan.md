# E2E 測試計劃

## MTR PS-OHLR DUAT v4.0.0

**最後更新**: 2026-02-14
**測試類型**: 端對端測試（手動 + 自動化）
**測試環境**: Windows 10/11 乾淨環境（無 Python / Node.js）

---

## 1. 測試範圍

本文件涵蓋 MTR DUAT 可攜式 .exe 的端對端測試場景，驗證從啟動到關閉的完整使用者流程。

### 1.1 測試前置條件

| 項目 | 說明 |
|------|------|
| 測試機器 | Windows 10/11 64-bit，無 Python / Node.js |
| 測試檔案 | 至少 5 個 `PS-OHLR_DUAT_Daily Report_*.docx` 檔案 |
| Project Master | 1 個 Project Master Excel 檔案 |
| 磁碟空間 | 至少 500 MB 可用空間 |
| 網路 | 測試離線場景時需可斷開網路 |

---

## 2. 測試場景

### E2E-01: 首次啟動

| 項目 | 說明 |
|------|------|
| 前置條件 | 乾淨環境，首次執行 .exe |
| 操作步驟 | 1. 雙擊 `MTR_DUAT_4.0.0.exe` |
| 預期結果 | 1. 顯示載入畫面（Loading screen）|
|          | 2. 載入畫面顯示 Sidecar 啟動日誌 |
|          | 3. Sidecar 就緒後自動切換至首頁 |
|          | 4. 首頁顯示「選擇資料夾」按鈕 |
| 通過標準 | 從啟動到首頁顯示 < 15 秒 |
| 狀態 | [ ] 待測 |

### E2E-02: 資料夾選擇

| 項目 | 說明 |
|------|------|
| 前置條件 | 應用已啟動，顯示首頁 |
| 操作步驟 | 1. 點擊「選擇資料夾」按鈕 |
|          | 2. 在原生對話框中選擇包含 DOCX 的資料夾 |
| 預期結果 | 1. 開啟 Windows 原生資料夾選擇對話框 |
|          | 2. 選擇後路徑顯示在頁面上 |
|          | 3. 偵測到的 DOCX 檔案數量顯示 |
| 通過標準 | 路徑正確顯示，檔案數量 > 0 |
| 狀態 | [ ] 待測 |

### E2E-03: DOCX 解析

| 項目 | 說明 |
|------|------|
| 前置條件 | 已選擇包含 DOCX 檔案的資料夾 |
| 操作步驟 | 1. 點擊「開始解析」按鈕 |
|          | 2. 等待解析完成 |
| 預期結果 | 1. 顯示進度條和當前處理檔案名稱 |
|          | 2. 進度從 0% 遞增至 100% |
|          | 3. 完成後顯示解析結果數量 |
|          | 4. 顯示成功通知 |
| 通過標準 | 解析結果數量 > 0，無錯誤通知 |
| 狀態 | [ ] 待測 |

### E2E-04: 儀表板瀏覽

| 項目 | 說明 |
|------|------|
| 前置條件 | 已解析數據，已觸發儀表板分析 |
| 操作步驟 | 1. 導航至儀表板頁面 |
|          | 2. 檢視統計卡片 |
|          | 3. 切換各圖表標籤 |
| 預期結果 | 1. 統計卡片顯示：總記錄數、總 NTH、總數量、專案數 |
|          | 2. 週趨勢圖表正確渲染（有數據點） |
|          | 3. 月趨勢圖表正確渲染 |
|          | 4. 專案分佈圖表正確渲染 |
|          | 5. 關鍵字分佈圖表正確渲染 |
|          | 6. 線路分佈圖表正確渲染 |
|          | 7. NTH 趨勢樞紐表正確渲染 |
| 通過標準 | 所有 6 種圖表均有數據渲染，無空白圖表 |
| 狀態 | [ ] 待測 |

### E2E-05: Excel 匯出

| 項目 | 說明 |
|------|------|
| 前置條件 | 已分析數據 |
| 操作步驟 | 1. 在儀表板頁面點擊「匯出 Excel」 |
|          | 2. 選擇儲存位置 |
| 預期結果 | 1. 下載有效的 .xlsx 檔案 |
|          | 2. Excel 包含 Raw Data、Summary by Project、NTH Trend 工作表 |
|          | 3. 數據與儀表板顯示一致 |
| 通過標準 | Excel 可正常開啟，包含 3 個工作表，數據非空 |
| 狀態 | [ ] 待測 |

### E2E-06: 語言切換

| 項目 | 說明 |
|------|------|
| 前置條件 | 應用已啟動，任何頁面 |
| 操作步驟 | 1. 點擊語言切換按鈕（EN/中） |
|          | 2. 瀏覽各頁面確認文字 |
|          | 3. 再次切換回原語言 |
| 預期結果 | 1. 所有頁面標題、按鈕、標籤文字更新為目標語言 |
|          | 2. 側邊欄導航文字更新 |
|          | 3. 圖表標籤更新 |
|          | 4. 切換回原語言後所有文字恢復 |
| 通過標準 | 無未翻譯的文字殘留 |
| 狀態 | [ ] 待測 |

### E2E-07: 設定持久化

| 項目 | 說明 |
|------|------|
| 前置條件 | 應用已啟動 |
| 操作步驟 | 1. 切換語言為中文 |
|          | 2. 選擇一個資料夾路徑 |
|          | 3. 關閉應用程式 |
|          | 4. 重新啟動應用程式 |
| 預期結果 | 1. 語言仍為中文 |
|          | 2. 上次選擇的資料夾路徑仍顯示 |
|          | 3. 設定檔 `mtr_duat_config.json` 存在於 .exe 同目錄 |
| 通過標準 | 所有設定在重啟後保留 |
| 狀態 | [ ] 待測 |

### E2E-08: Sidecar 崩潰恢復

| 項目 | 說明 |
|------|------|
| 前置條件 | 應用正常運行中 |
| 操作步驟 | 1. 開啟工作管理員 |
|          | 2. 找到 `backend.exe` 進程並結束它 |
|          | 3. 觀察應用反應 |
| 預期結果 | 1. 應用顯示錯誤對話框：「Backend 意外退出」 |
|          | 2. 對話框提供「重試」和「退出」按鈕 |
|          | 3. 點擊「重試」後 Sidecar 重新啟動 |
|          | 4. 重啟成功後恢復正常使用 |
| 通過標準 | 不會無提示崩潰，重試功能正常 |
| 狀態 | [ ] 待測 |

### E2E-09: 多實例防護

| 項目 | 說明 |
|------|------|
| 前置條件 | 應用已啟動 |
| 操作步驟 | 1. 再次雙擊 `MTR_DUAT_4.0.0.exe` |
| 預期結果 | 1. 不會開啟第二個視窗 |
|          | 2. 已有視窗被聚焦（如果最小化則恢復） |
| 通過標準 | 始終只有一個應用實例 |
| 狀態 | [ ] 待測 |

---

## 3. 環境驗證測試

### E2E-10: 無 Python 環境啟動

| 項目 | 說明 |
|------|------|
| 前置條件 | Windows VM，未安裝 Python |
| 操作步驟 | 1. 複製 .exe 至 VM |
|          | 2. 啟動 .exe |
|          | 3. 執行完整解析流程 |
| 預期結果 | 應用正常啟動和運行 |
| 驗證命令 | `python --version` 應回傳「不是內部或外部命令」 |
| 狀態 | [ ] 待測 |

### E2E-11: 無 Node.js 環境啟動

| 項目 | 說明 |
|------|------|
| 前置條件 | Windows VM，未安裝 Node.js |
| 操作步驟 | 1. 複製 .exe 至 VM |
|          | 2. 啟動 .exe |
| 預期結果 | 應用正常啟動和運行 |
| 驗證命令 | `node --version` 應回傳「不是內部或外部命令」 |
| 狀態 | [ ] 待測 |

### E2E-12: SharePoint 同步資料夾讀取

| 項目 | 說明 |
|------|------|
| 前置條件 | SharePoint 同步資料夾包含 DOCX 檔案 |
| 操作步驟 | 1. 選擇 SharePoint 同步路徑（通常含空格和中文） |
|          | 2. 執行解析 |
| 預期結果 | 1. 路徑正確處理（含空格、中文字元） |
|          | 2. 解析結果正確 |
| 注意事項 | 路徑範例：`C:\Users\使用者\OneDrive - MTR\DUAT Reports` |
| 狀態 | [ ] 待測 |

### E2E-13: 離線運作

| 項目 | 說明 |
|------|------|
| 前置條件 | 應用已啟動 |
| 操作步驟 | 1. 斷開網路連線 |
|          | 2. 執行所有功能（解析、分析、匯出） |
| 預期結果 | 所有功能正常運作，無網路相關錯誤 |
| 狀態 | [ ] 待測 |

---

## 4. 效能測試

### E2E-14: 啟動時間

| 項目 | 說明 |
|------|------|
| 測量方式 | 從雙擊 .exe 到首頁完全顯示的時間 |
| 目標 | < 15 秒 |
| 狀態 | [ ] 待測 |

### E2E-15: 解析效能

| 項目 | 說明 |
|------|------|
| 測量方式 | 解析 100 個 DOCX 檔案的時間 |
| 目標 | < 10 秒（10 files/sec） |
| 狀態 | [ ] 待測 |

### E2E-16: 儀表板載入

| 項目 | 說明 |
|------|------|
| 測量方式 | 觸發分析到圖表完全渲染的時間 |
| 目標 | < 2 秒（10,000 筆記錄） |
| 狀態 | [ ] 待測 |

---

## 5. 測試結果摘要

| 測試 ID | 場景 | 結果 | 備註 |
|---------|------|------|------|
| E2E-01 | 首次啟動 | 待測 | |
| E2E-02 | 資料夾選擇 | 待測 | |
| E2E-03 | DOCX 解析 | 待測 | |
| E2E-04 | 儀表板瀏覽 | 待測 | |
| E2E-05 | Excel 匯出 | 待測 | |
| E2E-06 | 語言切換 | 待測 | |
| E2E-07 | 設定持久化 | 待測 | |
| E2E-08 | Sidecar 崩潰恢復 | 待測 | |
| E2E-09 | 多實例防護 | 待測 | |
| E2E-10 | 無 Python 環境 | 待測 | |
| E2E-11 | 無 Node.js 環境 | 待測 | |
| E2E-12 | SharePoint 路徑 | 待測 | |
| E2E-13 | 離線運作 | 待測 | |
| E2E-14 | 啟動時間 | 待測 | |
| E2E-15 | 解析效能 | 待測 | |
| E2E-16 | 儀表板載入 | 待測 | |

**總計**: 16 個測試場景 | **通過**: 0 | **失敗**: 0 | **待測**: 16
